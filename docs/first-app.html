<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>1 Your First Shiny App | Building Web Apps with R Shiny</title>
<meta name="author" content="Lisa DeBruine">
<meta name="description" content="1.1 The Demo App To start, let's walk through the basics of setting up a shiny app, starting with the example built into RStudio. I won't explain yet how shiny apps are structured; the goal is to...">
<meta name="generator" content="bookdown 0.25 with bs4_book()">
<meta property="og:title" content="1 Your First Shiny App | Building Web Apps with R Shiny">
<meta property="og:type" content="book">
<meta property="og:url" content="https://debruine.github.io/shinyintro/first-app.html">
<meta property="og:image" content="https://debruine.github.io/shinyintro/images/logos/shinyintro.png">
<meta property="og:description" content="1.1 The Demo App To start, let's walk through the basics of setting up a shiny app, starting with the example built into RStudio. I won't explain yet how shiny apps are structured; the goal is to...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="1 Your First Shiny App | Building Web Apps with R Shiny">
<meta name="twitter:description" content="1.1 The Demo App To start, let's walk through the basics of setting up a shiny app, starting with the example built into RStudio. I won't explain yet how shiny apps are structured; the goal is to...">
<meta name="twitter:image" content="https://debruine.github.io/shinyintro/images/logos/shinyintro.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-6NP3MF25W3"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-6NP3MF25W3');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="include/psyteachr.css">
<link rel="stylesheet" href="include/webex.css">
<link rel="stylesheet" href="include/style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="[&lt;a href='/shinyintro.pdf'&gt;PDF&lt;/a&gt; | &lt;a href='/shinyintro.epub'&gt;EPUB&lt;/a&gt; | &lt;a href='/shinyintro.mobi'&gt;MOBI&lt;/a&gt;]">Building Web Apps with R Shiny</a>:
        <small class="text-muted">[<a href="/shinyintro.pdf">PDF</a> | <a href="/shinyintro.epub">EPUB</a> | <a href="/shinyintro.mobi">MOBI</a>]</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Overview</a></li>
<li><a class="active" href="first-app.html"><span class="header-section-number">1</span> Your First Shiny App</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/debruine/shinyintro">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="first-app" class="section level1" number="1">
<h1>
<span class="header-section-number">1</span> Your First Shiny App<a class="anchor" aria-label="anchor" href="#first-app"><i class="fas fa-link"></i></a>
</h1>
<div id="the-demo-app" class="section level2" number="1.1">
<h2>
<span class="header-section-number">1.1</span> The Demo App<a class="anchor" aria-label="anchor" href="#the-demo-app"><i class="fas fa-link"></i></a>
</h2>
<p>To start, let's walk through the basics of setting up a <a class="glossary" target="_blank" title="An R package that builds interactive web apps" href="https://psyteachr.github.io/glossary/s#shiny">shiny</a> app, starting with the example built into <a class="glossary" target="_blank" title="An integrated development environment (IDE) that helps you process R code." href="https://psyteachr.github.io/glossary/r#rstudio">RStudio</a>. I won't explain yet how shiny apps are structured; the goal is to just get something up and running, and give you some familiarity with the layout of a fairly simple app.</p>
<div id="set-up-the-demo-app" class="section level3" number="1.1.1">
<h3>
<span class="header-section-number">1.1.1</span> Set Up the Demo App<a class="anchor" aria-label="anchor" href="#set-up-the-demo-app"><i class="fas fa-link"></i></a>
</h3>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:first-demo"></span>
<img src="images/demo_app/01-create-project.png" alt="Creating a demo app." width="30%"><img src="images/demo_app/02-project-type.png" alt="Creating a demo app." width="30%"><img src="images/demo_app/03-project-directory.png" alt="Creating a demo app." width="30%"><p class="caption">
Figure 1.1: Creating a demo app.
</p>
</div>
<ol style="list-style-type: decimal">
<li><p>Under the <strong><code>File</code></strong> menu, choose <strong><code>New Project...</code></strong>. You will see a popup window like the one above. Choose <strong><code>New Directory</code></strong>.</p></li>
<li><p>Choose <strong><code>Shiny Web Application</code></strong> as the <a class="glossary" target="_blank" title="A way to organise related files in RStudio" href="https://psyteachr.github.io/glossary/p#project">project</a> type.</p></li>
<li><p>I like to put all of my apps in the same <a class="glossary" target="_blank" title='A collection or "folder" of files on a computer.' href="https://psyteachr.github.io/glossary/d#directory">directory</a>, but it doesn't matter where you save it.</p></li>
</ol>
<p>Your RStudio interface should look like this now.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:first-rstudio-interface"></span>
<img src="images/demo_app/04-rstudio-interface.png" alt="RStudio interface with the built-in demo app loaded." width="100%"><p class="caption">
Figure 1.2: RStudio interface with the built-in demo app loaded.
</p>
</div>
<div class="warning">
<p>If you are not using RStudio or your source code doesn't look like this, replace it with the code below:</p>
<div class="webex-solution">
<button>
View Code
</button>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#</span>
<span class="co"># This is a Shiny web application. You can run the application by clicking</span>
<span class="co"># the 'Run App' button above.</span>
<span class="co">#</span>
<span class="co"># Find out more about building applications with Shiny here:</span>
<span class="co">#</span>
<span class="co">#    http://shiny.rstudio.com/</span>
<span class="co">#</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://shiny.rstudio.com/">shiny</a></span><span class="op">)</span>

<span class="co"># Define UI for application that draws a histogram</span>
<span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html">fluidPage</a></span><span class="op">(</span>
   
   <span class="co"># Application title</span>
   <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/titlePanel.html">titlePanel</a></span><span class="op">(</span><span class="st">"Old Faithful Geyser Data"</span><span class="op">)</span>,
   
   <span class="co"># Sidebar with a slider input for number of bins </span>
   <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/sidebarLayout.html">sidebarLayout</a></span><span class="op">(</span>
      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/sidebarLayout.html">sidebarPanel</a></span><span class="op">(</span>
         <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/sliderInput.html">sliderInput</a></span><span class="op">(</span><span class="st">"bins"</span>,
                     <span class="st">"Number of bins:"</span>,
                     min <span class="op">=</span> <span class="fl">1</span>,
                     max <span class="op">=</span> <span class="fl">50</span>,
                     value <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>
      <span class="op">)</span>,
      
      <span class="co"># Show a plot of the generated distribution</span>
      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/sidebarLayout.html">mainPanel</a></span><span class="op">(</span>
         <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/plotOutput.html">plotOutput</a></span><span class="op">(</span><span class="st">"distPlot"</span><span class="op">)</span>
      <span class="op">)</span>
   <span class="op">)</span>
<span class="op">)</span>

<span class="co"># Define server logic required to draw a histogram</span>
<span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span><span class="op">)</span> <span class="op">{</span>
   
   <span class="va">output</span><span class="op">$</span><span class="va">distPlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderPlot.html">renderPlot</a></span><span class="op">(</span><span class="op">{</span>
      <span class="co"># generate bins based on input$bins from ui.R</span>
      <span class="va">x</span>    <span class="op">&lt;-</span> <span class="va">faithful</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> 
      <span class="va">bins</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">bins</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>
      
      <span class="co"># draw the histogram with the specified number of bins</span>
      <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">x</span>, breaks <span class="op">=</span> <span class="va">bins</span>, col <span class="op">=</span> <span class="st">'darkgray'</span>, border <span class="op">=</span> <span class="st">'white'</span><span class="op">)</span>
   <span class="op">}</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># Run the application </span>
<span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html">shinyApp</a></span><span class="op">(</span>ui <span class="op">=</span> <span class="va">ui</span>, server <span class="op">=</span> <span class="va">server</span><span class="op">)</span></code></pre></div>
</div>
</div>
<p>Click on <strong><code>Run App</code></strong> in the top right corner of the <a class="glossary" target="_blank" title='RStudio is arranged with four window "panes".' href="https://psyteachr.github.io/glossary/p#panes">source pane</a>. The app will open up in a new window. Play with the slider and watch the histogram change.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:first-app-interface"></span>
<img src="images/demo_app/05-app-interface.png" alt="Demo application interface" width="100%"><p class="caption">
Figure 1.3: Demo application interface
</p>
</div>
<div class="info">
<p>You can also open up the app in a web browser by clicking on <code>Open in Browser</code>.</p>
</div>
</div>
<div id="modify-the-demo-app" class="section level3" number="1.1.2">
<h3>
<span class="header-section-number">1.1.2</span> Modify the Demo App<a class="anchor" aria-label="anchor" href="#modify-the-demo-app"><i class="fas fa-link"></i></a>
</h3>
<p>Now we're going to make a series of changes to the demo app until it's all your own.</p>
<div class="info">
<p>You can close the app by closing the window or browser tab it's running in and clicking the red stop sign in the console tab, or leave it running while you edit the code. If you have multiple screens, it can be useful to have the app open on one screen and the code on another.</p>
</div>
<p>Find the application title. It is the first <a class="glossary" target="_blank" title="A variable that provides input to a function." href="https://psyteachr.github.io/glossary/a#argument">argument</a> to the <a class="glossary" target="_blank" title="A named section of code that can be reused." href="https://psyteachr.github.io/glossary/f#function">function</a> <code><span class="fu">titlePanel</span>()</code>. Change the <code><span class="at">title</span></code> to <code><span class="st">"My First App"</span></code>. Make sure the title is inside quotes and the whole quoted <a class="glossary" target="_blank" title="A piece of text inside of quotes." href="https://psyteachr.github.io/glossary/s#string">string</a> is inside the parentheses. Save the file (<code>cmd-S</code> or <code>File &gt; Save</code>).</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:first-change-title"></span>
<img src="images/demo_app/06-change-title.png" alt="App with changed title." width="100%"><p class="caption">
Figure 1.4: App with changed title.
</p>
</div>
<p>Click <strong><code>Run App</code></strong> (or <strong><code>Reload App</code></strong> if you haven't closed the app window) in the <a class="glossary" target="_blank" title='RStudio is arranged with four window "panes".' href="https://psyteachr.github.io/glossary/p#panes">source pane</a>. If you haven't saved your changes, it will prompt you to do so. Check that the app title has changed.</p>
<p>Now let's change the input. Find the function <code><span class="fu">sliderInput</span>()</code> (line 21). The first <a class="glossary" target="_blank" title="A variable that provides input to a function." href="https://psyteachr.github.io/glossary/a#argument">argument</a> is the name you can use in the code to find the value of this input, so don't change it just yet. The second argument is the text that displays before the slider. Change this to something else and re-run the app.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/sliderInput.html">sliderInput</a></span><span class="op">(</span><span class="st">"bins"</span>,
            <span class="st">"Number of bins:"</span>,
            min <span class="op">=</span> <span class="fl">0</span>,
            max <span class="op">=</span> <span class="fl">50</span>,
            value <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></code></pre></div>
<div class="try">
<p>See if you can figure out what the next three arguments to <code><span class="fu">sliderInput</span>()</code> do. Change them to different <a class="glossary" target="_blank" title="A data type representing whole numbers." href="https://psyteachr.github.io/glossary/i#integer">integers</a>, then re-run the app to see what's changed.</p>
</div>
<p>The arguments to the function <code><span class="fu">sidebarPanel</span>()</code> are just a list of things you want to display in the sidebar. To add some explanatory text in a paragraph before <code><span class="fu">sliderInput</span>()</code>, just use the paragraph function <code><span class="fu">p</span>()</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/sidebarLayout.html">sidebarPanel</a></span><span class="op">(</span>
   <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">p</a></span><span class="op">(</span><span class="st">"I am explaining this perfectly"</span><span class="op">)</span>,
   <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/sliderInput.html">sliderInput</a></span><span class="op">(</span><span class="st">"bins"</span>,
               <span class="st">"Choose the best bin number:"</span>,
               min <span class="op">=</span> <span class="fl">10</span>,
               max <span class="op">=</span> <span class="fl">40</span>,
               value <span class="op">=</span> <span class="fl">25</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:first-app-sidebar-p"></span>
<img src="images/demo_app/07-app-sidebar-p.png" alt="Sidebar with an added paragraph." width="100%"><p class="caption">
Figure 1.5: Sidebar with an added paragraph.
</p>
</div>
<div class="info">
<p>The sidebar shows up on the left if your window is wide enough, but moves to the top of the screen if it's too narrow.</p>
</div>
<p>I don't like it there, so we can move this text out of the sidebar and to the top of the page, just under the title. Try this and re-run the app.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="first-app.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Application title</span></span>
<span id="cb8-2"><a href="first-app.html#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">titlePanel</span>(<span class="st">"My First App"</span>),</span>
<span id="cb8-3"><a href="first-app.html#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="first-app.html#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">p</span>(<span class="st">"I am explaining this perfectly"</span>),</span>
<span id="cb8-5"><a href="first-app.html#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="first-app.html#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Sidebar with a slider input for number of bins</span></span>
<span id="cb8-7"><a href="first-app.html#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="fu">sidebarLayout</span>(...)</span></code></pre></div>
<div class="try">
<p>See where you can move the text in the layout of the page and where causes errors.</p>
</div>
<p>I'm also not keen on the grey plot. We can change the plot colour inside <code><a href="https://rdrr.io/r/graphics/hist.html">hist()</a></code></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># draw the histogram with the specified number of bins</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">x</span>, breaks <span class="op">=</span> <span class="va">bins</span>, col <span class="op">=</span> <span class="st">'steelblue3'</span>, border <span class="op">=</span> <span class="st">'grey30'</span><span class="op">)</span></code></pre></div>
<p>There are a lot of ways to represent colour in R. The easiest three are:</p>
<ol style="list-style-type: decimal">
<li>hexadecimal colours (e.g., <code><span class="st">"#0066CC"</span></code>)</li>
<li>the <code>rgb</code> or <code>hsl</code> functions (e.g., <code>rgb(0, .4, .8)</code>)</li>
<li>colour names (type <code><span class="fu">colours</span>()</code> in the console)</li>
</ol>
<p>The color <code><span class="st">"steelblue3"</span></code> is pretty close to the shiny interface default colour, but feel free to choose whatever you like.</p>
<p>I prefer ggplots, so let's make the plot with <code><span class="fu">geom_histogram</span>()</code> instead of <code><span class="fu">hist</span>()</code> (which is a great function for really quick plots, but not very visually appealing). Since we need several functions from the <code class="package">ggplot2</code> <a class="glossary" target="_blank" title="A group of R functions." href="https://psyteachr.github.io/glossary/p#package">package</a>, we'll need to load that package at the top of the script, just under where the <code class="package">shiny</code> package is loaded:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://shiny.rstudio.com/">shiny</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></code></pre></div>
<p>You can replace all of the code in <code><span class="fu">renderPlot</span>()</code> with the code below.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">output</span><span class="op">$</span><span class="va">distPlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderPlot.html">renderPlot</a></span><span class="op">(</span><span class="op">{</span>
  <span class="co"># create plot</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">faithful</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">waiting</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">bins</span>,
                   fill <span class="op">=</span> <span class="st">"steelblue3"</span>,
                   colour <span class="op">=</span> <span class="st">"grey30"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"What are we even plotting here?"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span></code></pre></div>
<div class="info">
<p>You can set <code><span class="at">fill</span></code> and <code><span class="at">colour</span></code> to whatever colours you like, and change <code><span class="fu">theme_minimal</span>()</code> to one of the other <a href="https://ggplot2.tidyverse.org/reference/ggtheme.html#examples" target="_blank">built-in ggplot themes</a>.</p>
</div>
<div class="try">
<p>What <em>are</em> we even plotting here? Type <code><a href="https://rdrr.io/r/datasets/faithful.html">?faithful</a></code> into the console pane to see what the <code>waiting</code> column represents (<code>faithful</code> is a built-in demo dataset). Change the label on the x-axis to something more sensible.</p>
</div>
</div>
<div id="add-new-things" class="section level3" number="1.1.3">
<h3>
<span class="header-section-number">1.1.3</span> Add New Things<a class="anchor" aria-label="anchor" href="#add-new-things"><i class="fas fa-link"></i></a>
</h3>
<p>The <code>faithful</code> dataset includes two columns: <code>eruptions</code> and <code>waiting</code>. We've been plotting the <code>waiting</code> variable, but what if you wanted to plot the <code>eruptions</code> variable instead?</p>
<div class="try">
<p>Try plotting the eruption time (<code>eruptions</code>) instead of the waiting time. You just have to change one word in <code><span class="fu">ggplot</span>()</code> and update the x-axis label.</p>
</div>
<p>We can add another input <a class="glossary" target="_blank" title="A interactive web element, like a dropdown menu or a slider." href="https://psyteachr.github.io/glossary/w#widget">widget</a> to let the user switch between plotting eruption time and wait time. We'll learn more about the different input options in SectionÂ <a href="#inputs"><strong>??</strong></a>. We need to toggle between two options, so we can use either radio buttons or a select box. Radio buttons are probably best if you have only a few options and the user will want to see them all at the same time to decide.</p>
<p>Add the following code as the first argument to <code><span class="fu">sidebarPanel</span>()</code>, which just takes a list of different widgets. <code><span class="fu">radioButtons</span>()</code> is the widget we're using. We'll set four <a class="glossary" target="_blank" title="A variable that provides input to a function." href="https://psyteachr.github.io/glossary/a#argument">arguments</a>:</p>
<ul>
<li>
<code><span class="at">inputId</span></code>: a unique identifier that we will use later in the code to find the value of this widget</li>
<li>
<code><span class="at">label</span></code>: the text to display to the user</li>
<li>
<code><span class="at">choices</span></code>: a list of choices in the format <code>c("label1" = "value1", "label2" = "value2", ...)</code>
</li>
<li>
<code><span class="at">selected</span></code>: the value of the default choice</li>
</ul>
<p>For <code><span class="at">choices</span></code>, the label is what gets shown to the user and the value is what gets used by the code (these can be the same, but you often want the user label to be more descriptive).</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="first-app.html#cb12-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">radioButtons</span>(<span class="at">inputId =</span> <span class="st">"display_var"</span>,</span>
<span id="cb12-2"><a href="first-app.html#cb12-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">label =</span> <span class="st">"Which variable to display"</span>,</span>
<span id="cb12-3"><a href="first-app.html#cb12-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">choices =</span> <span class="fu">c</span>(<span class="st">"Waiting time to next eruption"</span> <span class="ot">=</span> <span class="st">"waiting"</span>,</span>
<span id="cb12-4"><a href="first-app.html#cb12-4" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Eruption time"</span> <span class="ot">=</span> <span class="st">"eruptions"</span>),</span>
<span id="cb12-5"><a href="first-app.html#cb12-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">selected =</span> <span class="st">"waiting"</span></span>
<span id="cb12-6"><a href="first-app.html#cb12-6" aria-hidden="true" tabindex="-1"></a> ),</span></code></pre></div>
<p>Save this and re-run the app.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:first-radiobutton-widget"></span>
<img src="images/demo_app/08-radiobutton-widget.png" alt="A radioButton widget above a sliderInput widget." width="100%"><p class="caption">
Figure 1.6: A radioButton widget above a sliderInput widget.
</p>
</div>
<p>You should have a radio button interface now. You can click on the options to switch the button, but it won't do anything to your plot yet. We need to edit the plot-generating code to make that happen.</p>
<p>First, we need to change the x-axis label depending on what we're graphing. We use an if/else statement to set the variable <code>xlabel</code> to one thing if <code>input$display_var</code> is equivalent to <code><span class="st">"eruptions"</span></code>, and to something else if it's equivalent to <code><span class="st">"waiting"</span></code>. Put this code at the very beginning of the code block for <code><span class="fu">renderPlot</span>()</code> (after the line <code>output$distPlot &lt;- renderPlot({</code>).</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># set x-axis label depending on the value of display_var</span>
<span class="kw">if</span> <span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">display_var</span> <span class="op">==</span> <span class="st">"eruptions"</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">xlabel</span> <span class="op">&lt;-</span> <span class="st">"Eruption Time (in minutes)"</span>
<span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">display_var</span> <span class="op">==</span> <span class="st">"waiting"</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">xlabel</span> <span class="op">&lt;-</span> <span class="st">"Waiting Time to Next Eruption (in minutes)"</span>
<span class="op">}</span></code></pre></div>
<div class="warning">
<p>The double-equal-signs <code>==</code> means "equivalent to and is how you check if two things are the same; if you only use one equal sign, you set the variable on the left to the value on the right.</p>
</div>
<p>Then we have to edit <code><span class="fu">ggplot</span>()</code> to use the new label and to plot the correct column. The variable <code>input$display_var</code> gives you the user-input value of the widget called <code>"display_var"</code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create plot</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">faithful</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">.data</span><span class="op">[[</span><span class="va">input</span><span class="op">$</span><span class="va">display_var</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">bins</span>,
                 fill <span class="op">=</span> <span class="st">"steelblue3"</span>,
                 colour <span class="op">=</span> <span class="st">"grey30"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="va">xlabel</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>::: {.warning data-latex=""}
Notice that the code <code><span class="fu">aes</span>(waiting)</code> from before has changed to <code><span class="fu">aes</span>(.data[[input<span class="math inline">\(display_var]])&lt;/code&gt;. Because `input\)</span>display_var<code>is a &lt;a class='glossary' target='_blank' title='A piece of text inside of quotes.' href='https://psyteachr.github.io/glossary/s#string'&gt;string&lt;/a&gt;, we have to select it from the</code>.data<code>placeholder (which refers to the</code>faithful` data table) using double brackets.
:::]]) %&gt;%
summarise_if(is.numeric, input$stat, na.rm = TRUE)
})</code></p>
<p>output<span class="math inline">\(caption &lt;- renderText({  sprintf("%ss by %s", toupper(input\)</span>stat), input$group)
})
}</p>
<pre><code>
&lt;/div&gt;



### reactive {-}

Use &lt;code&gt;&lt;span class='fu'&gt;reactive&lt;/span&gt;()&lt;/code&gt; to update the output table and caption whenever group or stat change. Ignore the update button.


&lt;div class='webex-solution'&gt;&lt;button&gt;Solution&lt;/button&gt;


```r
server &lt;- function(input, output, session) {
  data &lt;- reactive({
    msleep %&gt;%
      group_by(.data[[input$group]]) %&gt;%
      summarise_if(is.numeric, input$stat, na.rm = TRUE)
  })
  output$table &lt;- renderTable(data())
  
  caption &lt;- reactive({
    sprintf("%ss by %s", toupper(input$stat), input$group)
  })
  output$caption &lt;- renderText(caption())
} </code></pre>
</div>
</div>
<div id="observeevent" class="section level3 unnumbered">
<h3>observeEvent<a class="anchor" aria-label="anchor" href="#observeevent"><i class="fas fa-link"></i></a>
</h3>
<p>Use <code><span class="fu">observeEvent</span>()</code> to update the output table with the appropriate summary table and to update the caption with an appropriate caption only when the update button is clicked.</p>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html">observeEvent</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">update</span>, <span class="op">{</span>
    <span class="va">data</span> <span class="op">&lt;-</span> <span class="va">msleep</span> <span class="op">%&gt;%</span>
      <span class="fu">group_by</span><span class="op">(</span><span class="va">.data</span><span class="op">[[</span><span class="va">input</span><span class="op">$</span><span class="va">group</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">%&gt;%</span>
      <span class="fu">summarise_if</span><span class="op">(</span><span class="va">is.numeric</span>, <span class="va">input</span><span class="op">$</span><span class="va">stat</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
    <span class="va">output</span><span class="op">$</span><span class="va">table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderTable.html">renderTable</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>
    
    <span class="va">caption</span> <span class="op">&lt;-</span>
      <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%ss by %s"</span>, <span class="fu"><a href="https://rdrr.io/r/base/chartr.html">toupper</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">stat</span><span class="op">)</span>, <span class="va">input</span><span class="op">$</span><span class="va">group</span><span class="op">)</span>
    <span class="va">output</span><span class="op">$</span><span class="va">caption</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderPrint.html">renderText</a></span><span class="op">(</span><span class="va">caption</span><span class="op">)</span>
  <span class="op">}</span><span class="op">)</span>
<span class="op">}</span> </code></pre></div>
</div>
</div>
<div id="reactiveval" class="section level3 unnumbered">
<h3>reactiveVal<a class="anchor" aria-label="anchor" href="#reactiveval"><i class="fas fa-link"></i></a>
</h3>
<p>Use <code><span class="fu">reactiveVal</span>()</code> to update the output table and caption only when the update button is clicked.</p>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactiveVal.html">reactiveVal</a></span><span class="op">(</span><span class="op">)</span>
  <span class="va">caption</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactiveVal.html">reactiveVal</a></span><span class="op">(</span><span class="op">)</span>
  
  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html">observeEvent</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">update</span>, <span class="op">{</span>
    <span class="va">newdata</span> <span class="op">&lt;-</span> <span class="va">msleep</span> <span class="op">%&gt;%</span>
      <span class="fu">group_by</span><span class="op">(</span><span class="va">.data</span><span class="op">[[</span><span class="va">input</span><span class="op">$</span><span class="va">group</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">%&gt;%</span>
      <span class="fu">summarise_if</span><span class="op">(</span><span class="va">is.numeric</span>, <span class="va">input</span><span class="op">$</span><span class="va">stat</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">newdata</span><span class="op">)</span>
    
    <span class="co"># this is an alternative way to set reactiveVal</span>
    <span class="co"># by piping the value into the function</span>
    <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%ss by %s"</span>, <span class="fu"><a href="https://rdrr.io/r/base/chartr.html">toupper</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">stat</span><span class="op">)</span>, <span class="va">input</span><span class="op">$</span><span class="va">group</span><span class="op">)</span> <span class="op">%&gt;%</span>
      <span class="fu">caption</span><span class="op">(</span><span class="op">)</span>
  <span class="op">}</span><span class="op">)</span>
  
  <span class="va">output</span><span class="op">$</span><span class="va">table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderTable.html">renderTable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
  <span class="va">output</span><span class="op">$</span><span class="va">caption</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderPrint.html">renderText</a></span><span class="op">(</span><span class="fu">caption</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span> </code></pre></div>
</div>
</div>
<div id="reactivevalues" class="section level3 unnumbered">
<h3>reactiveValues<a class="anchor" aria-label="anchor" href="#reactivevalues"><i class="fas fa-link"></i></a>
</h3>
<p>Use <code><span class="fu">reactiveValues</span>()</code> to update the output table and caption only when the update button is clicked.</p>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactiveValues.html">reactiveValues</a></span><span class="op">(</span><span class="op">)</span>
  
  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html">observeEvent</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">update</span>, <span class="op">{</span>
    <span class="va">v</span><span class="op">$</span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">msleep</span> <span class="op">%&gt;%</span>
      <span class="fu">group_by</span><span class="op">(</span><span class="va">.data</span><span class="op">[[</span><span class="va">input</span><span class="op">$</span><span class="va">group</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">%&gt;%</span>
      <span class="fu">summarise_if</span><span class="op">(</span><span class="va">is.numeric</span>, <span class="va">input</span><span class="op">$</span><span class="va">stat</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
    
    <span class="va">v</span><span class="op">$</span><span class="va">caption</span> <span class="op">&lt;-</span>
      <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%ss by %s"</span>, <span class="fu"><a href="https://rdrr.io/r/base/chartr.html">toupper</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">stat</span><span class="op">)</span>, <span class="va">input</span><span class="op">$</span><span class="va">group</span><span class="op">)</span>
  <span class="op">}</span><span class="op">)</span>
  
  <span class="va">output</span><span class="op">$</span><span class="va">table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderTable.html">renderTable</a></span><span class="op">(</span><span class="va">v</span><span class="op">$</span><span class="va">data</span><span class="op">)</span>
  <span class="va">output</span><span class="op">$</span><span class="va">caption</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderPrint.html">renderText</a></span><span class="op">(</span><span class="va">v</span><span class="op">$</span><span class="va">caption</span><span class="op">)</span>
<span class="op">}</span> </code></pre></div>
</div>
</div>
<div id="eventreactive" class="section level3 unnumbered">
<h3>eventReactive<a class="anchor" aria-label="anchor" href="#eventreactive"><i class="fas fa-link"></i></a>
</h3>
<p>Use <code><span class="fu">eventReactive</span>()</code> to update the output table and caption only when the update button is clicked.</p>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html">eventReactive</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">update</span>, <span class="op">{</span>
    <span class="va">msleep</span> <span class="op">%&gt;%</span>
      <span class="fu">group_by</span><span class="op">(</span><span class="va">.data</span><span class="op">[[</span><span class="va">input</span><span class="op">$</span><span class="va">group</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">%&gt;%</span>
      <span class="fu">summarise_if</span><span class="op">(</span><span class="va">is.numeric</span>, <span class="va">input</span><span class="op">$</span><span class="va">stat</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
  <span class="op">}</span><span class="op">)</span>
  <span class="va">output</span><span class="op">$</span><span class="va">table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderTable.html">renderTable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
  
  <span class="va">caption</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html">eventReactive</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">update</span>, <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%ss by %s"</span>, <span class="fu"><a href="https://rdrr.io/r/base/chartr.html">toupper</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">stat</span><span class="op">)</span>, <span class="va">input</span><span class="op">$</span><span class="va">group</span><span class="op">)</span>
  <span class="op">}</span><span class="op">)</span>
  <span class="va">output</span><span class="op">$</span><span class="va">caption</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderPrint.html">renderText</a></span><span class="op">(</span><span class="fu">caption</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span> </code></pre></div>
</div>
</div>
</div>
<div id="your-app-reactive" class="section level2" number="1.2">
<h2>
<span class="header-section-number">1.2</span> Your App<a class="anchor" aria-label="anchor" href="#your-app-reactive"><i class="fas fa-link"></i></a>
</h2>
<p>Add reactive functions to your custom app. Think about which patterns are best for your app. For example, if you need to update a data table when inputs change, and then use it in more than one output, it's best to use <code><span class="fu">reactive</span>()</code> to create a function for the data and callit in the render functions for each output, rather than creating the data table in each render function.</p>

</div>
<div class="chapter-nav">
<div class="prev"><a href="index.html">Overview</a></div>
<div class="empty"></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#first-app"><span class="header-section-number">1</span> Your First Shiny App</a></li>
<li>
<a class="nav-link" href="#the-demo-app"><span class="header-section-number">1.1</span> The Demo App</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#set-up-the-demo-app"><span class="header-section-number">1.1.1</span> Set Up the Demo App</a></li>
<li><a class="nav-link" href="#modify-the-demo-app"><span class="header-section-number">1.1.2</span> Modify the Demo App</a></li>
<li><a class="nav-link" href="#add-new-things"><span class="header-section-number">1.1.3</span> Add New Things</a></li>
<li><a class="nav-link" href="#observeevent">observeEvent</a></li>
<li><a class="nav-link" href="#reactiveval">reactiveVal</a></li>
<li><a class="nav-link" href="#reactivevalues">reactiveValues</a></li>
<li><a class="nav-link" href="#eventreactive">eventReactive</a></li>
</ul>
</li>
<li><a class="nav-link" href="#your-app-reactive"><span class="header-section-number">1.2</span> Your App</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/debruine/shinyintro/blob/master/book/05_reactive.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/debruine/shinyintro/edit/master/book/05_reactive.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>
</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;

    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    $(solveme[i]).after(" <span class='webex-icon'></span>");
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    $(selects[i]).after(" <span class='webex-icon'></span>");
  }

  update_total_correct();
}

</script><script>
$( document ).ready(function() {
  var cite = ' ';
  var psyteachr = ' <a href="https://psyteachr.github.io/"><img src="images/logos/psyteachr_logo.png" style="height: 31px; color: white;" alt="psyTeachR: Reproducible Research" /></a>';
  var license = ' <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/" target="blank"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png"></a>';

  $("footer div.row div:eq(1) p").html(
    psyteachr + license + cite
  );

  // open rdrr links externally
  $("a[href^='https://rdrr.io']").click(function(){
    window.open(this.href);
    return false;
  });

  // visible second sidebar in mobile
  function move_sidebar() {
    var w = window.innerWidth;
    if (w < 992) {
      $("#toc").appendTo($("#main-nav"));
    } else {
      $("#toc").appendTo($("div.sidebar-chapter"));
    }
  }
  move_sidebar();
  window.onresize = move_sidebar;
});
</script>

</div>
 <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Building Web Apps with R Shiny</strong>: [<a href="/shinyintro.pdf">PDF</a> | <a href="/shinyintro.epub">EPUB</a> | <a href="/shinyintro.mobi">MOBI</a>]" was written by Lisa DeBruine. It was last built on 2022-03-28.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
